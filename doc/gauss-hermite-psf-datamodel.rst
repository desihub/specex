==============
Datamodel: psf
==============

General Description
===================

Summary
-------

Gauss-Hermite PSF fits file generated by specex, https://github.com/julienguy/specex. Primary HDU is empty. It only contains the PSF type (keyword PSFTYPE) and version (keyword PSFVERSION) of the format.

Naming Convention
-----------------

``psf-AS-EXPNUM.fits``, where A is the spectrograph arm ('b','r' or 'z'), S the spectrograph identifier [0-9], and EXPNUM the exposure number.

File Type
---------

FITS, 2 MB

Contents
========

====== ======= ======== ===================
Number EXTNAME Type     Contents           
====== ======= ======== ===================
HDU0_          IMAGE    *Brief Description*
====== ======= ======== ===================


FITS Header Units
=================

HDU0
----

*Summarize the contents of this HDU.*

Required Header Keywords
~~~~~~~~~~~~~~~~~~~~~~~~

======= ============= ==== =======
KEY     Value         Type Comment
======= ============= ==== =======
PSFTYPE GAUSS-HERMITE str  Type of PSF (several PSF models in specex)       
PSFVER  2             str  Version of the fits format for this PSFTYPE       
======= ============= ==== =======

HDU1
----

This HDU contains all the data that describe the spectrograph PSF for
a given spectrograph arm/CCD. Each row of the table contains the data
vector of one PSF parameter.

The size of the vector is ((FIBERMAX-FIBERMIN+1)*(LEGDEG+1))            

Description of  the NPARAMS parameters :                                

X        : CCD column coordinate (as a function of fiber and wavelength)

Y        : CCD row coordinate (as a function of fiber and wavelength) 
(X,Y)=(0,0) means that PSF is centered on center of first pixel

GHSIGX   : Sigma of first Gaussian along CCD columns for PSF core       

GHSIGY   : Sigma of first Gaussian along CCD rows for PSF core          

GH-i-j   : Hermite pol. coefficents, i along columns, j along rows,     
i is integer from 0 to GHDEGX, j is integer from 0 to GHDEGY,  
there are (GHDEGX+1)*(GHDEGY+1) such coefficents.              

TAILAMP  : Amplitude of PSF tail                                        

TAILCORE : Size in pixels of PSF tail saturation in PSF core            

TAILXSCA : Scaling apply to CCD coordinate along columns for PSF tail   

TAILYSCA : Scaling apply to CCD coordinate along rows for PSF tail      

TAILINDE : Asymptotic power law index of PSF tail                       

CONT     : Continuum flux in arc image (not part of PSF)                


PSF_core(X,Y) = [ SUM_ij (GH-i-j)*HERM(i,X/GHSIGX)*HERM(j,Y/GHSIGX) ]*GAUS(X,GHSIGX)*GAUS(Y,GHSIGY)   

PSF_tail(X,Y) = TAILAMP*R^2/(TAILCORE^2+R^2)^(1+TAILINDE/2) with R^2=(X/TAILXSCA)^2+(Y/TAILYSCA)^2

PSF_core is integrated in pixel, PSF_tail is not, it is evaluated at center of pixel.   

Required Header Keywords
~~~~~~~~~~~~~~~~~~~~~~~~

======== ============= ===== ===============================================
KEY      Value         Type  Comment                                        
======== ============= ===== ===============================================
TDIM4    ( 8, 500)     str   dimension                                      
PSFTYPE  GAUSS-HERMITE str   Type of PSF (several PSF models in specex)
PSFVER   2             str   Version of the fits format for this PSFTYPE
MJD      0             int   MJD of arc lamp exposure                       
PLATEID  0             int   plate ID of arc lamp exposure                  
CAMERA                 str   camera ID                                      
ARCEXP   0             int   ID of arc lamp exposure used to fit PSF        
NPIX_X   4096          int   number of columns in input CCD image           
NPIX_Y   4096          int   number of rows in input CCD image              
HSIZEX   14            int   Half size of PSF in fit, NX=2*HSIZEX+1         
HSIZEY   8             int   Half size of PSF in fit, NY=2*HSIZEY+1         
BUNDLMIN 0             int   first bundle of fibers (starting at 0)         
BUNDLMAX 19            int   last bundle of fibers (included)               
FIBERMIN 0             int   first fiber (starting at 0)                    
FIBERMAX 499           int   last fiber (included)                          
NPARAMS  91            int   number of PSF parameters                       
LEGDEG   7             int   degree of Legendre pol.(wave) for parameters   
GHDEGX   8             int   degree of Hermite polynomial along CCD columns 
GHDEGY   8             int   degree of Hermite polynomial along CCD rows    
PSFERROR 0.0           float assumed PSF fractional error in chi2           
READNOIS 3.0           float assumed read out noise in chi2                 
GAIN     1.0           float assumed gain in chi2                           
B00RCHI2 1.08258523592 float best fit chi2/ndf for fiber bundle 0           
B00NDATA 108113        int   number of pixels in fit for fiber bundle 0     
B00NPAR  300           int   number of parameters in fit for fiber bundle 0 
B01RCHI2 1.06868257857 float best fit chi2/ndf for fiber bundle 1           
B01NDATA 106579        int   number of pixels in fit for fiber bundle 1     
B01NPAR  300           int   number of parameters in fit for fiber bundle 1 
B02RCHI2 1.06369204663 float best fit chi2/ndf for fiber bundle 2           
B02NDATA 109548        int   number of pixels in fit for fiber bundle 2     
B02NPAR  300           int   number of parameters in fit for fiber bundle 2 
B03RCHI2 1.0600293665  float best fit chi2/ndf for fiber bundle 3           
B03NDATA 111428        int   number of pixels in fit for fiber bundle 3     
B03NPAR  300           int   number of parameters in fit for fiber bundle 3 
B04RCHI2 1.04223822903 float best fit chi2/ndf for fiber bundle 4           
B04NDATA 113267        int   number of pixels in fit for fiber bundle 4     
B04NPAR  300           int   number of parameters in fit for fiber bundle 4 
B05RCHI2 1.04182632579 float best fit chi2/ndf for fiber bundle 5           
B05NDATA 109378        int   number of pixels in fit for fiber bundle 5     
B05NPAR  300           int   number of parameters in fit for fiber bundle 5 
B06RCHI2 1.03915097469 float best fit chi2/ndf for fiber bundle 6           
B06NDATA 112439        int   number of pixels in fit for fiber bundle 6     
B06NPAR  300           int   number of parameters in fit for fiber bundle 6 
B07RCHI2 1.04007209934 float best fit chi2/ndf for fiber bundle 7           
B07NDATA 111312        int   number of pixels in fit for fiber bundle 7     
B07NPAR  300           int   number of parameters in fit for fiber bundle 7 
B08RCHI2 1.03864768304 float best fit chi2/ndf for fiber bundle 8           
B08NDATA 109597        int   number of pixels in fit for fiber bundle 8     
B08NPAR  300           int   number of parameters in fit for fiber bundle 8 
B09RCHI2 1.03497713679 float best fit chi2/ndf for fiber bundle 9           
B09NDATA 107137        int   number of pixels in fit for fiber bundle 9     
B09NPAR  300           int   number of parameters in fit for fiber bundle 9 
B10RCHI2 1.03348537317 float best fit chi2/ndf for fiber bundle 10          
B10NDATA 110195        int   number of pixels in fit for fiber bundle 10    
B10NPAR  300           int   number of parameters in fit for fiber bundle 10
B11RCHI2 1.028577689   float best fit chi2/ndf for fiber bundle 11          
B11NDATA 113000        int   number of pixels in fit for fiber bundle 11    
B11NPAR  300           int   number of parameters in fit for fiber bundle 11
B12RCHI2 1.02646328765 float best fit chi2/ndf for fiber bundle 12          
B12NDATA 108698        int   number of pixels in fit for fiber bundle 12    
B12NPAR  300           int   number of parameters in fit for fiber bundle 12
B13RCHI2 1.03449996142 float best fit chi2/ndf for fiber bundle 13          
B13NDATA 112152        int   number of pixels in fit for fiber bundle 13    
B13NPAR  300           int   number of parameters in fit for fiber bundle 13
B14RCHI2 1.04524018774 float best fit chi2/ndf for fiber bundle 14          
B14NDATA 110893        int   number of pixels in fit for fiber bundle 14    
B14NPAR  300           int   number of parameters in fit for fiber bundle 14
B15RCHI2 1.0447008985  float best fit chi2/ndf for fiber bundle 15          
B15NDATA 114187        int   number of pixels in fit for fiber bundle 15    
B15NPAR  300           int   number of parameters in fit for fiber bundle 15
B16RCHI2 1.04619881905 float best fit chi2/ndf for fiber bundle 16          
B16NDATA 113353        int   number of pixels in fit for fiber bundle 16    
B16NPAR  300           int   number of parameters in fit for fiber bundle 16
B17RCHI2 1.05194622818 float best fit chi2/ndf for fiber bundle 17          
B17NDATA 110907        int   number of pixels in fit for fiber bundle 17    
B17NPAR  300           int   number of parameters in fit for fiber bundle 17
B18RCHI2 1.07010665725 float best fit chi2/ndf for fiber bundle 18          
B18NDATA 106152        int   number of pixels in fit for fiber bundle 18    
B18NPAR  300           int   number of parameters in fit for fiber bundle 18
B19RCHI2 1.07055353735 float best fit chi2/ndf for fiber bundle 19          
B19NDATA 110910        int   number of pixels in fit for fiber bundle 19    
B19NPAR  300           int   number of parameters in fit for fiber bundle 19
======== ============= ===== ===============================================

Required Data Table Columns
~~~~~~~~~~~~~~~~~~~~~~~~~~~

======= ============= ===== ===================
Name    Type          Units Description        
======= ============= ===== ===================
PARAM   char[8]             label for field   1
WAVEMIN float64             label for field   2
WAVEMAX float64             label for field   3
COEFF   float64[4000]       label for field   4
======= ============= ===== ===================


Notes and Examples
==================

This documentation was written for the output of specex version 0.3.4.

